diff --git a/app/Http/Controllers/DocumentController.php b/app/Http/Controllers/DocumentController.php
index 210dabb..03b64e5 100644
--- a/app/Http/Controllers/DocumentController.php
+++ b/app/Http/Controllers/DocumentController.php
@@ -70,14 +70,18 @@ public function index(Request $request)
             's_title' => 'nullable',
             's_ancient_author' => 'nullable',
             's_genres' => 'nullable',
+            's_genres_incl' => 'nullable',
             's_tags' => 'nullable',
+            's_tags_incl' => 'nullable',
             's_earliest_date' => 'nullable',
             's_latest_date' => 'nullable',
             's_exclusive_date' => 'nullable',
             's_dating_methods' => 'nullable',
+            's_dating_methods_incl' => 'nullable',
             's_dating_certainties' => 'nullable',
             's_materials' => 'nullable',
             's_inks' => 'nullable',
+            's_inks_incl' => 'nullable',
             's_covers' => 'nullable',
             's_quire_structures' => 'nullable',
             's_quirenum_min' => 'nullable',
@@ -103,20 +107,29 @@ public function index(Request $request)
             's_hand_number_min' => 'nullable',
             's_hand_number_max' => 'nullable',
             's_scripts' => 'nullable',
+            's_scripts_incl' => 'nullable',
             's_diacritics' => 'nullable',
+            's_diacritics_incl' => 'nullable',
             's_punctuations' => 'nullable',
+            's_punctuations_incl' => 'nullable',
             's_paratexts' => 'nullable',
+            's_paratexts_incl' => 'nullable',
             's_decorations' => 'nullable',
+            's_decorations_incl' => 'nullable',
             's_critical_symbols' => 'nullable',
+            's_critical_symbols_incl' => 'nullable',
             's_paginations' => 'nullable',
             's_quire_signatures' => 'nullable',
             's_storage_conditions' => 'nullable',
             's_analyses' => 'nullable',
+            's_analyses_incl' => 'nullable',
             's_scientifically_excavated' => 'nullable',
             's_ancient_provenances' => 'nullable',
             's_ancient_provenance_certainties' => 'nullable',
             's_transactions' => 'nullable',
+            's_transactions_incl' => 'nullable',
             's_transaction_parties' => 'nullable',
+            's_transaction_parties_incl' => 'nullable',
             's_legal_classifications' => 'nullable',
             'sortfield' => 'nullable',
             'reverse' => 'nullable',
@@ -187,14 +200,18 @@ public function index(Request $request)
         $title = array_key_exists('s_title', $search) ? $search['s_title'] : null;
         $ancient_author = array_key_exists('s_ancient_author', $search) ? $search['s_ancient_author'] : null;
         $genres = array_key_exists('s_genres', $search) ? $search['s_genres'] : null;
+        $genres_incl = array_key_exists('s_genres_incl', $search) ? $search['s_genres_incl'] : null;
         $tags = array_key_exists('s_tags', $search) ? $search['s_tags'] : null;
+        $tags_incl = array_key_exists('s_tags_incl', $search) ? $search['s_tags_incl'] : null;
         $earliest_date = array_key_exists('s_earliest_date', $search) ? $search['s_earliest_date'] : null;
         $latest_date = array_key_exists('s_latest_date', $search) ? $search['s_latest_date'] : null;
         $exclusive_date = array_key_exists('s_exclusive_date', $search) ? $search['s_exclusive_date'] : false;
         $dating_methods = array_key_exists('s_dating_methods', $search) ? $search['s_dating_methods'] : null;
+        $dating_methods_incl = array_key_exists('s_dating_methods_incl', $search) ? $search['s_dating_methods_incl'] : null;
         $dating_certainties = array_key_exists('s_dating_certainties', $search) ? $search['s_dating_certainties'] : null;
         $materials = array_key_exists('s_materials', $search) ? $search['s_materials'] : null;
         $inks = array_key_exists('s_inks', $search) ? $search['s_inks'] : null;
+        $inks_incl = array_key_exists('s_inks_incl', $search) ? $search['s_inks_incl'] : null;
         $covers = array_key_exists('s_covers', $search) ? $search['s_covers'] : null;
         $quire_structures = array_key_exists('s_quire_structures', $search) ? $search['s_quire_structures'] : null;
         $quirenum_min = array_key_exists('s_quirenum_min', $search) ? $search['s_quirenum_min'] : null;
@@ -220,20 +237,29 @@ public function index(Request $request)
         $hand_number_min = array_key_exists('s_hand_number_min', $search) ? $search['s_hand_number_min'] : null;
         $hand_number_max = array_key_exists('s_hand_number_max', $search) ? $search['s_hand_number_max'] : null;
         $scripts = array_key_exists('s_scripts', $search) ? $search['s_scripts'] : null;
+        $scripts_incl = array_key_exists('s_scripts_incl', $search) ? $search['s_scripts_incl'] : null;
         $diacritics = array_key_exists('s_diacritics', $search) ? $search['s_diacritics'] : null;
+        $diacritics_incl = array_key_exists('s_diacritics_incl', $search) ? $search['s_diacritics_incl'] : null;
         $punctuations = array_key_exists('s_punctuations', $search) ? $search['s_punctuations'] : null;
+        $punctuations_incl = array_key_exists('s_punctuations_incl', $search) ? $search['s_punctuations_incl'] : null;
         $paratexts = array_key_exists('s_paratexts', $search) ? $search['s_paratexts'] : null;
+        $paratexts_incl = array_key_exists('s_paratexts_incl', $search) ? $search['s_paratexts_incl'] : null;
         $decorations = array_key_exists('s_decorations', $search) ? $search['s_decorations'] : null;
+        $decorations_incl = array_key_exists('s_decorations_incl', $search) ? $search['s_decorations_incl'] : null;
         $critical_symbols = array_key_exists('s_critical_symbols', $search) ? $search['s_critical_symbols'] : null;
+        $critical_symbols_incl = array_key_exists('s_critical_symbols_incl', $search) ? $search['s_critical_symbols_incl'] : null;
         $paginations = array_key_exists('s_pagination', $search) ? $search['s_paginations'] : null;
         $quire_signatures = array_key_exists('s_quire_signatures', $search) ? $search['s_quire_signatures'] : null;
         $storage_conditions = array_key_exists('s_storage_conditions', $search) ? $search['s_storage_conditions'] : null;
         $analyses = array_key_exists('s_analyses', $search) ? $search['s_analyses'] : null;
+        $analyses_incl = array_key_exists('s_analyses_incl', $search) ? $search['s_analyses_incl'] : null;
         $scientifically_excavated = array_key_exists('s_scientifically_excavated', $search) ? $search['s_scientifically_excavated'] : null;
         $ancient_provenances = array_key_exists('s_ancient_provenances', $search) ? $search['s_ancient_provenances'] : null;
         $ancient_provenance_certainties = array_key_exists('s_ancient_provenance_certainties', $search) ? $search['s_ancient_provenance_certainties'] : null;
         $transactions = array_key_exists('s_transactions', $search) ? $search['s_transactions'] : null;
+        $transactions_incl = array_key_exists('s_transactions_incl', $search) ? $search['s_transactions_incl'] : null;
         $transaction_parties = array_key_exists('s_transaction_parties', $search) ? $search['s_transaction_parties'] : null;
+        $transaction_parties_incl = array_key_exists('s_transaction_parties_incl', $search) ? $search['s_transaction_parties_incl'] : null;
         $legal_classifications = array_key_exists('s_legal_classifications', $search) ? $search['s_legal_classifications'] : null;
 
         $ancient_provenances_original = $ancient_provenances;
@@ -320,7 +346,9 @@ public function index(Request $request)
                 $title,
                 $ancient_author,
                 $genres,
-                $tags
+                $genres_incl,
+                $tags,
+                $tags_incl,
             ) {
                 $query->when($title, function ($query, $title) {
                     $query->where('title', 'like', "%{$title}%");
@@ -328,22 +356,37 @@ public function index(Request $request)
                     ->when($ancient_author, function ($query, $ancient_author) {
                         $query->where('ancient_author', 'like', "%{$ancient_author}%");
                     })
-                    ->when($genres, function ($query, $genres) {
+                    ->when($genres && !$genres_incl, function ($query) use ($genres) {
                         $query->whereHas('genres', function ($query) use ($genres) {
                             $query->whereIn('genres.id', array_column($genres, 'id'));
                         });
                     })
-                    ->when($tags, function ($query, $tags) {
+                    ->when($genres && $genres_incl, function ($query) use ($genres) {
+                        foreach($genres as $genre) {                                
+                            $query->whereHas('genres', function($query) use ($genre) {
+                                $query->where('genres.id', '=', $genre['id']);
+                            });
+                        }
+                    }) 
+                    ->when($tags && !$tags_incl, function ($query) use ($tags) {
                         $query->whereHas('tags', function ($query) use ($tags) {
                             $query->whereIn('tags.id', array_column($tags, 'id'));
                         });
-                    });
+                    })
+                    ->when($tags && $tags_incl, function ($query) use ($tags) {
+                        foreach($tags as $tag) {                                
+                            $query->whereHas('tags', function($query) use ($tag) {
+                                $query->where('tags.id', '=', $tag['id']);
+                            });
+                        }
+                    }); 
             })
             ->when($show_dating == "true", function ($query) use (
                 $earliest_date,
                 $latest_date,
                 $exclusive_date,
                 $dating_methods,
+                $dating_methods_incl,
                 $dating_certainties
             ) {
                 $query->when($exclusive_date == "true", function ($query) use ($earliest_date, $latest_date, $exclusive_date) {
@@ -361,11 +404,18 @@ public function index(Request $request)
                             $query->where('start_year', '<=', $latest_date);
                         });
                 })
-                    ->when($dating_methods, function ($query, $dating_methods) {
+                    ->when($dating_methods && !$dating_methods_incl, function ($query) use ($dating_methods) {
                         $query->whereHas('dating_methods', function ($query) use ($dating_methods) {
                             $query->whereIn('dating_methods.id', array_column($dating_methods, 'id'));
                         });
                     })
+                    ->when($dating_methods && $dating_methods_incl, function ($query) use ($dating_methods) {
+                        foreach($dating_methods as $dating_method) {                                
+                            $query->whereHas('dating_methods', function($query) use ($dating_method) {
+                                $query->where('dating_methods.id', '=', $dating_method['id']);
+                            });
+                        }
+                    }) 
                     ->when($dating_certainties, function ($query, $dating_certainties) {
                         $query->whereIn('dating_certainty_id', array_column($dating_certainties, 'id'));
                     });
@@ -375,6 +425,7 @@ public function index(Request $request)
                 function ($query) use (
                     $materials,
                     $inks,
+                    $inks_incl,
                     $covers,
                     $quire_structures,
                     $quirenum_min,
@@ -382,14 +433,21 @@ function ($query) use (
                     $bifolianum_min,
                     $bifolianum_max
                 ) {
-                    $query->when($materials, function ($query, $materials) {
-                        $query->whereIn('material_id', array_column($materials, 'id'));
-                    })
-                        ->when($inks, function ($query, $inks) {
+                        $query->when($materials, function ($query, $materials) {
+                            $query->whereIn('material_id', array_column($materials, 'id'));
+                        })
+                        ->when(($inks && !$inks_incl), function ($query) use ($inks) {
                             $query->whereHas('inks', function ($query) use ($inks) {
                                 $query->whereIn('inks.id', array_column($inks, 'id'));
                             });
                         })
+                        ->when($inks && $inks_incl, function ($query) use ($inks) {
+                            foreach($inks as $ink) {                                
+                                $query->whereHas('inks', function($query) use ($ink) {
+                                    $query->where('inks.id', '=', $ink['id']);
+                                });
+                            }
+                        })                      
                         ->when($covers, function ($query, $covers) {
                             $query->whereIn('cover_id', array_column($covers, 'id'));
                         })
@@ -487,11 +545,17 @@ function ($query) use (
                     $hand_number_min,
                     $hand_number_max,
                     $scripts,
+                    $scripts_incl,
                     $diacritics,
+                    $diacritics_incl,
                     $punctuations,
+                    $punctuations_incl,
                     $paratexts,
+                    $paratexts_incl,
                     $decorations,
+                    $decorations_incl,
                     $critical_symbols,
+                    $critical_symbols_incl,
                     $paginations,
                     $quire_signatures
                 ) {
@@ -501,36 +565,78 @@ function ($query) use (
                         ->when($hand_number_max, function ($query, $hand_number_max) {
                             $query->where('hand_number', '<=', $hand_number_max);
                         })
-                        ->when($scripts, function ($query, $scripts) {
+                        ->when($scripts && !$scripts_incl, function ($query) use ($scripts) {
                             $query->whereHas('scripts', function ($query) use ($scripts) {
                                 $query->whereIn('scripts.id', array_column($scripts, 'id'));
                             });
                         })
-                        ->when($diacritics, function ($query, $diacritics) {
+                        ->when($scripts && $scripts_incl, function ($query) use ($scripts) {
+                            foreach($scripts as $script) {                                
+                                $query->whereHas('scripts', function($query) use ($script) {
+                                    $query->where('scripts.id', '=', $script['id']);
+                                });
+                            }
+                        }) 
+                        ->when($diacritics && !$diacritics_incl, function ($query) use ($diacritics) {
                             $query->whereHas('diacritics', function ($query) use ($diacritics) {
                                 $query->whereIn('diacritics.id', array_column($diacritics, 'id'));
                             });
                         })
-                        ->when($punctuations, function ($query, $punctuations) {
+                        ->when($diacritics && $diacritics_incl, function ($query) use ($diacritics) {
+                            foreach($diacritics as $diacritic) {                                
+                                $query->whereHas('diacritics', function($query) use ($diacritic) {
+                                    $query->where('diacritics.id', '=', $diacritic['id']);
+                                });
+                            }
+                        }) 
+                        ->when($punctuations && !$punctuations_incl, function ($query) use ($punctuations) {
                             $query->whereHas('punctuations', function ($query) use ($punctuations) {
                                 $query->whereIn('punctuations.id', array_column($punctuations, 'id'));
                             });
                         })
-                        ->when($paratexts, function ($query, $paratexts) {
+                        ->when($punctuations && $punctuations_incl, function ($query) use ($punctuations) {
+                            foreach($punctuations as $punctuation) {                                
+                                $query->whereHas('punctuations', function($query) use ($punctuation) {
+                                    $query->where('punctuations.id', '=', $punctuation['id']);
+                                });
+                            }
+                        }) 
+                        ->when($paratexts && !$paratexts_incl, function ($query) use ($paratexts) {
                             $query->whereHas('paratexts', function ($query) use ($paratexts) {
                                 $query->whereIn('paratexts.id', array_column($paratexts, 'id'));
                             });
                         })
-                        ->when($decorations, function ($query, $decorations) {
+                        ->when($paratexts && $paratexts_incl, function ($query) use ($paratexts) {
+                            foreach($paratexts as $paratext) {                                
+                                $query->whereHas('paratexts', function($query) use ($paratext) {
+                                    $query->where('paratexts.id', '=', $paratext['id']);
+                                });
+                            }
+                        }) 
+                        ->when($decorations && !$decorations_incl, function ($query) use ($decorations) {
                             $query->whereHas('decorations', function ($query) use ($decorations) {
                                 $query->whereIn('decorations.id', array_column($decorations, 'id'));
                             });
                         })
-                        ->when($critical_symbols, function ($query, $critical_symbols) {
+                        ->when($decorations && $decorations_incl, function ($query) use ($decorations) {
+                            foreach($decorations as $decoration) {                                
+                                $query->whereHas('decorations', function($query) use ($decoration) {
+                                    $query->where('decorations.id', '=', $decoration['id']);
+                                });
+                            }
+                        }) 
+                        ->when($critical_symbols && !$critical_symbols_incl, function ($query) use ($critical_symbols) {
                             $query->whereHas('critical_symbols', function ($query) use ($critical_symbols) {
                                 $query->whereIn('critical_symbols.id', array_column($critical_symbols, 'id'));
                             });
                         })
+                        ->when($critical_symbols && $critical_symbols_incl, function ($query) use ($critical_symbols) {
+                            foreach($critical_symbols as $critical_symbol) {                                
+                                $query->whereHas('critical_symbols', function($query) use ($critical_symbol) {
+                                    $query->where('critical_symbols.id', '=', $critical_symbol['id']);
+                                });
+                            }
+                        }) 
                         ->when($paginations, function ($query, $paginations) {
                             $query->whereHas('paginations', function ($query) use ($paginations) {
                                 $query->whereIn('paginations.id', array_column($paginations, 'id'));
@@ -545,15 +651,23 @@ function ($query) use (
                 $show_consanal == "true",
                 function ($query) use (
                     $storage_conditions,
-                    $analyses
+                    $analyses,
+                    $analyses_incl,
                 ) {
                     $query->when($storage_conditions, function ($query, $storage_conditions) {
                         $query->whereIn('storage_condition_id', array_column($storage_conditions, 'id'));
                     })
-                        ->when($analyses, function ($query, $analyses) {
+                        ->when($analyses && !$analyses_incl, function ($query) use ($analyses) {
                             $query->whereHas('analyses', function ($query) use ($analyses) {
                                 $query->whereIn('analyses.id', array_column($analyses, 'id'));
                             });
+                        })
+                        ->when($analyses && $analyses_incl, function ($query) use ($analyses) {
+                            foreach($analyses as $analysis) {                                
+                                $query->whereHas('analyses', function($query) use ($analysis) {
+                                    $query->where('analyses.id', '=', $analysis['id']);
+                                });
+                            }
                         });
                 }
             )
@@ -564,7 +678,9 @@ function ($query) use (
                     $ancient_provenances,
                     $ancient_provenance_certainties,
                     $transactions,
+                    $transactions_incl,
                     $transaction_parties,
+                    $transaction_parties_incl,
                     $legal_classifications
                 ) {
                     $query->when($scientifically_excavated, function ($query, $scientifically_excavated) {
@@ -576,12 +692,20 @@ function ($query) use (
                         ->when($ancient_provenance_certainties, function ($query, $ancient_provenance_certainties) {
                             $query->whereIn('ancient_provenance_certainty_id', array_column($ancient_provenance_certainties, 'id'));
                         })
-                        ->when($transactions, function ($query, $transactions) {
+                        ->when($transactions && !$transactions_incl, function ($query) use ($transactions) {
                             $query->whereHas('purchases', function ($query) use ($transactions) {
                                 $query->whereIn('purchases.id', array_column($transactions, 'id'));
                             });
                         })
-                        ->when($transaction_parties, function ($query, $transaction_parties) {
+                        ->when($transactions && $transactions_incl, function ($query) use ($transactions) {
+                            foreach($transactions as $transaction) {                                
+                                $query->whereHas('purchases', function($query) use ($transaction) {
+                                    $query->where('purchases.id', '=', $transaction['id']);
+                                });
+                            }
+                        }) 
+
+                        ->when($transaction_parties && !$transaction_parties_incl, function ($query) use ($transaction_parties) {
                             $tactions = Purchase::query()
                                 ->whereHas('purchase_parties', function ($query) use ($transaction_parties) {
                                     $query->whereIn('purchase_parties.id', array_column($transaction_parties, 'id'));
@@ -590,11 +714,21 @@ function ($query) use (
                                 $query->whereIn('purchases.id', array_column($tactions, 'id'));
                             });
                         })
+
+                        ->when($transaction_parties && $transaction_parties_incl, function ($query) use ($transaction_parties) {
+                            
+                            $query->whereHas('purchases', function ($query) use ($transaction_parties) {
+                                foreach($transaction_parties as $transaction_party) {
+                                    $query->whereHas('purchase_parties', function ($query) use ($transaction_party) {
+                                        $query->where('purchase_parties.id', '=', $transaction_party['id']);
+                                    });
+                                }
+                            });
+                        })
                         ->when($legal_classifications, function ($query, $legal_classifications) {
                             $query->whereIn('legal_classification_id', array_column($legal_classifications, 'id'));
                         });
-                }
-            )
+                    })
 
             ->orderBy($sortby, $direction)
             ->orderBy('end_year', $direction);
@@ -646,14 +780,18 @@ function ($query) use (
             'title' => $title,
             'ancient_author' => $ancient_author,
             'genres_search' => $genres,
+            'genres_incl' => $genres_incl,
             'tags_search' => $tags,
+            'tags_incl' => $tags_incl,
             'earliest_date' => $earliest_date,
             'latest_date' => $latest_date,
             'exclusive_date' => $exclusive_date == "true" ? true : false,
             'dating_methods_search' => $dating_methods,
+            'dating_methods_incl' => $dating_methods_incl,
             'dating_certainties_search' => $dating_certainties,
             'materials_search' => $materials,
             'inks_search' => $inks,
+            'inks_incl' => $inks_incl == "true" ? true : false,
             'covers_search' => $covers,
             'quire_structures_search' => $quire_structures,
             'quirenum_min' => $quirenum_min,
@@ -679,20 +817,29 @@ function ($query) use (
             'hand_number_min' => $hand_number_min,
             'hand_number_max' => $hand_number_max,
             'scripts_search' => $scripts,
+            'scripts_incl' => $scripts_incl,
             'diacritics_search' => $diacritics,
+            'diacritics_incl' => $diacritics_incl,
             'punctuations_search' => $punctuations,
+            'punctuations_incl' => $punctuations_incl,
             'paratexts_search' => $paratexts,
+            'paratexts_incl' => $paratexts_incl,
             'decorations_search' => $decorations,
+            'decorations_incl' => $decorations_incl,
             'critical_symbols_search' => $critical_symbols,
+            'critical_symbols_incl' => $critical_symbols_incl,
             'paginations_search' => $paginations,
             'quire_signatures_search' => $quire_signatures,
             'storage_conditions_search' => $storage_conditions,
             'analyses_search' => $analyses,
+            'analyses_incl' => $analyses_incl,
             'scientifically_excavated' => $scientifically_excavated,
             'ancient_provenances_search' => $ancient_provenances,
             'ancient_provenance_certainties_search' => $ancient_provenance_certainties,
             'transactions_search' => $transactions,
+            'transactions_incl' => $transactions_incl,
             'transaction_parties_search' => $transaction_parties,
+            'transaction_parties_incl' => $transaction_parties_incl,
             'legal_classifications_search' => $legal_classifications,
             'sortfield' => $sortfield,
             'reverse' => $reverse,
@@ -759,14 +906,18 @@ public function show(Document  $document, Request $request)
             's_title' => 'nullable',
             's_ancient_author' => 'nullable',
             's_genres' => 'nullable',
+            's_genres_incl' => 'nullable',
             's_tags' => 'nullable',
+            's_tags_incl' => 'nullable',
             's_earliest_date' => 'nullable',
             's_latest_date' => 'nullable',
             's_exclusive_date' => 'nullable',
             's_dating_methods' => 'nullable',
+            's_dating_methods_incl' => 'nullable',
             's_dating_certainties' => 'nullable',
             's_materials' => 'nullable',
             's_inks' => 'nullable',
+            's_inks_incl' => 'nullable',
             's_covers' => 'nullable',
             's_quire_structures' => 'nullable',
             's_quirenum_min' => 'nullable',
@@ -792,20 +943,29 @@ public function show(Document  $document, Request $request)
             's_hand_number_min' => 'nullable',
             's_hand_number_max' => 'nullable',
             's_scripts' => 'nullable',
+            's_scripts_incl' => 'nullable',
             's_diacritics' => 'nullable',
+            's_diacritics_incl' => 'nullable',
             's_punctuations' => 'nullable',
+            's_punctuations_incl' => 'nullable',
             's_paratexts' => 'nullable',
+            's_paratexts_incl' => 'nullable',
             's_decorations' => 'nullable',
+            's_decorations_incl' => 'nullable',
             's_critical_symbols' => 'nullable',
+            's_critical_symbols_incl' => 'nullable',
             's_paginations' => 'nullable',
             's_quire_signatures' => 'nullable',
             's_storage_conditions' => 'nullable',
             's_analyses' => 'nullable',
+            's_analyses_incl' => 'nullable',
             's_scientifically_excavated' => 'nullable',
             's_ancient_provenances' => 'nullable',
             's_ancient_provenance_certainties' => 'nullable',
             's_transactions' => 'nullable',
+            's_transactions_incl' => 'nullable',
             's_transaction_parties' => 'nullable',
+            's_transaction_parties_incl' => 'nullable',
             's_legal_classifications' => 'nullable',
             'sortfield' => 'nullable',
             'reverse' => 'nullable',
@@ -860,14 +1020,18 @@ public function show(Document  $document, Request $request)
         $title = array_key_exists('s_title', $search) ? $search['s_title'] : null;
         $ancient_author = array_key_exists('s_ancient_author', $search) ? $search['s_ancient_author'] : null;
         $genres = array_key_exists('s_genres', $search) ? $search['s_genres'] : null;
+        $genres_incl = array_key_exists('s_genres_incl', $search) ? $search['s_genres_incl'] : null;
         $tags = array_key_exists('s_tags', $search) ? $search['s_tags'] : null;
+        $tags_incl = array_key_exists('s_tags_incl', $search) ? $search['s_tags_incl'] : null;
         $earliest_date = array_key_exists('s_earliest_date', $search) ? $search['s_earliest_date'] : null;
         $latest_date = array_key_exists('s_latest_date', $search) ? $search['s_latest_date'] : null;
         $exclusive_date = array_key_exists('s_exclusive_date', $search) ? $search['s_exclusive_date'] : false;
         $dating_methods = array_key_exists('s_dating_methods', $search) ? $search['s_dating_methods'] : null;
+        $dating_methods_incl = array_key_exists('s_dating_methods_incl', $search) ? $search['s_dating_methods_incl'] : null;
         $dating_certainties = array_key_exists('s_dating_certainties', $search) ? $search['s_dating_certainties'] : null;
         $materials = array_key_exists('s_materials', $search) ? $search['s_materials'] : null;
         $inks = array_key_exists('s_inks', $search) ? $search['s_inks'] : null;
+        $inks_incl = array_key_exists('s_inks_incl', $search) ? $search['s_inks_incl'] : null;
         $covers = array_key_exists('s_covers', $search) ? $search['s_covers'] : null;
         $quire_structures = array_key_exists('s_quire_structures', $search) ? $search['s_quire_structures'] : null;
         $quirenum_min = array_key_exists('s_quirenum_min', $search) ? $search['s_quirenum_min'] : null;
@@ -893,20 +1057,29 @@ public function show(Document  $document, Request $request)
         $hand_number_min = array_key_exists('s_hand_number_min', $search) ? $search['s_hand_number_min'] : null;
         $hand_number_max = array_key_exists('s_hand_number_max', $search) ? $search['s_hand_number_max'] : null;
         $scripts = array_key_exists('s_scripts', $search) ? $search['s_scripts'] : null;
+        $scripts_incl = array_key_exists('s_scripts_incl', $search) ? $search['s_scripts_incl'] : null;
         $diacritics = array_key_exists('s_diacritics', $search) ? $search['s_diacritics'] : null;
+        $diacritics_incl = array_key_exists('s_diacritics_incl', $search) ? $search['s_diacritics_incl'] : null;
         $punctuations = array_key_exists('s_punctuations', $search) ? $search['s_punctuations'] : null;
+        $punctuations_incl = array_key_exists('s_punctuations_incl', $search) ? $search['s_punctuations_incl'] : null;
         $paratexts = array_key_exists('s_paratexts', $search) ? $search['s_paratexts'] : null;
+        $paratexts_incl = array_key_exists('s_paratexts_incl', $search) ? $search['s_paratexts_incl'] : null;
         $decorations = array_key_exists('s_decorations', $search) ? $search['s_decorations'] : null;
+        $decorations_incl = array_key_exists('s_decorations_incl', $search) ? $search['s_decorations_incl'] : null;
         $critical_symbols = array_key_exists('s_critical_symbols', $search) ? $search['s_critical_symbols'] : null;
+        $critical_symbols_incl = array_key_exists('s_critical_symbols_incl', $search) ? $search['s_critical_symbols_incl'] : null;
         $paginations = array_key_exists('s_pagination', $search) ? $search['s_paginations'] : null;
         $quire_signatures = array_key_exists('s_quire_signatures', $search) ? $search['s_quire_signatures'] : null;
         $storage_conditions = array_key_exists('s_storage_conditions', $search) ? $search['s_storage_conditions'] : null;
         $analyses = array_key_exists('s_analyses', $search) ? $search['s_analyses'] : null;
+        $analyses_incl = array_key_exists('s_analyses_incl', $search) ? $search['s_analyses_incl'] : null;
         $scientifically_excavated = array_key_exists('s_scientifically_excavated', $search) ? $search['s_scientifically_excavated'] : null;
         $ancient_provenances = array_key_exists('s_ancient_provenances', $search) ? $search['s_ancient_provenances'] : null;
         $ancient_provenance_certainties = array_key_exists('s_ancient_provenance_certainties', $search) ? $search['s_ancient_provenance_certainties'] : null;
         $transactions = array_key_exists('s_transactions', $search) ? $search['s_transactions'] : null;
+        $transactions_incl = array_key_exists('s_transactions_incl', $search) ? $search['s_transactions_incl'] : null;
         $transaction_parties = array_key_exists('s_transaction_parties', $search) ? $search['s_transaction_parties'] : null;
+        $transaction_parties_incl = array_key_exists('s_transaction_parties_incl', $search) ? $search['s_transaction_parties_incl'] : null;
         $legal_classifications = array_key_exists('s_legal_classifications', $search) ? $search['s_legal_classifications'] : null;
         
         if($show_provenance AND $ancient_provenances) {
@@ -929,9 +1102,9 @@ public function show(Document  $document, Request $request)
         $all_documents = Document::query()
             ->when($role_id < 2, function ($query) {
                 $query->where('published', '=', true);
-            })
-            ->when($fulltext, function ($query, $fulltext) {
-                $query->where(function ($query) use ($fulltext) {
+            }) 
+            ->when($fulltext, function ($query) use ($fulltext, $role_id) {
+                $query->where(function ($query) use ($fulltext, $role_id) {
                     $query->where('standard_name', 'like', "%{$fulltext}%")
                         ->orWhere('standard_name', 'like', "%{$fulltext}%")
                         ->orWhere('other_names', 'like', "%{$fulltext}%")
@@ -965,7 +1138,7 @@ public function show(Document  $document, Request $request)
                         ->orWhere('bibliography', 'like', "%{$fulltext}%")
                         ->orWhere('images_info', 'like', "%{$fulltext}%")
                         ->orWhere('excavation_comment', 'like', "%{$fulltext}%")
-                        ->orWhere('internal_comment', 'like', "%{$fulltext}%");
+                        ->orWhere('internal_comment', 'like', $role_id >= 2 ? "%{$fulltext}%" : "notsomethinganyonewouldwrite");
                 });
             })
             ->when($show_publication == "true", function ($query) use (
@@ -991,7 +1164,9 @@ public function show(Document  $document, Request $request)
                 $title,
                 $ancient_author,
                 $genres,
-                $tags
+                $genres_incl,
+                $tags,
+                $tags_incl,
             ) {
                 $query->when($title, function ($query, $title) {
                     $query->where('title', 'like', "%{$title}%");
@@ -999,22 +1174,37 @@ public function show(Document  $document, Request $request)
                     ->when($ancient_author, function ($query, $ancient_author) {
                         $query->where('ancient_author', 'like', "%{$ancient_author}%");
                     })
-                    ->when($genres, function ($query, $genres) {
+                    ->when($genres && !$genres_incl, function ($query) use ($genres) {
                         $query->whereHas('genres', function ($query) use ($genres) {
                             $query->whereIn('genres.id', array_column($genres, 'id'));
                         });
                     })
-                    ->when($tags, function ($query, $tags) {
+                    ->when($genres && $genres_incl, function ($query) use ($genres) {
+                        foreach($genres as $genre) {                                
+                            $query->whereHas('genres', function($query) use ($genre) {
+                                $query->where('genres.id', '=', $genre['id']);
+                            });
+                        }
+                    }) 
+                    ->when($tags && !$tags_incl, function ($query) use ($tags) {
                         $query->whereHas('tags', function ($query) use ($tags) {
                             $query->whereIn('tags.id', array_column($tags, 'id'));
                         });
-                    });
+                    })
+                    ->when($tags && $tags_incl, function ($query) use ($tags) {
+                        foreach($tags as $tag) {                                
+                            $query->whereHas('tags', function($query) use ($tag) {
+                                $query->where('tags.id', '=', $tag['id']);
+                            });
+                        }
+                    }); 
             })
             ->when($show_dating == "true", function ($query) use (
                 $earliest_date,
                 $latest_date,
                 $exclusive_date,
                 $dating_methods,
+                $dating_methods_incl,
                 $dating_certainties
             ) {
                 $query->when($exclusive_date == "true", function ($query) use ($earliest_date, $latest_date, $exclusive_date) {
@@ -1032,11 +1222,18 @@ public function show(Document  $document, Request $request)
                             $query->where('start_year', '<=', $latest_date);
                         });
                 })
-                    ->when($dating_methods, function ($query, $dating_methods) {
+                    ->when($dating_methods && !$dating_methods_incl, function ($query) use ($dating_methods) {
                         $query->whereHas('dating_methods', function ($query) use ($dating_methods) {
                             $query->whereIn('dating_methods.id', array_column($dating_methods, 'id'));
                         });
                     })
+                    ->when($dating_methods && $dating_methods_incl, function ($query) use ($dating_methods) {
+                        foreach($dating_methods as $dating_method) {                                
+                            $query->whereHas('dating_methods', function($query) use ($dating_method) {
+                                $query->where('dating_methods.id', '=', $dating_method['id']);
+                            });
+                        }
+                    }) 
                     ->when($dating_certainties, function ($query, $dating_certainties) {
                         $query->whereIn('dating_certainty_id', array_column($dating_certainties, 'id'));
                     });
@@ -1046,6 +1243,7 @@ public function show(Document  $document, Request $request)
                 function ($query) use (
                     $materials,
                     $inks,
+                    $inks_incl,
                     $covers,
                     $quire_structures,
                     $quirenum_min,
@@ -1053,14 +1251,21 @@ function ($query) use (
                     $bifolianum_min,
                     $bifolianum_max
                 ) {
-                    $query->when($materials, function ($query, $materials) {
-                        $query->whereIn('material_id', array_column($materials, 'id'));
-                    })
-                        ->when($inks, function ($query, $inks) {
+                        $query->when($materials, function ($query, $materials) {
+                            $query->whereIn('material_id', array_column($materials, 'id'));
+                        })
+                        ->when(($inks && !$inks_incl), function ($query) use ($inks) {
                             $query->whereHas('inks', function ($query) use ($inks) {
                                 $query->whereIn('inks.id', array_column($inks, 'id'));
                             });
                         })
+                        ->when($inks && $inks_incl, function ($query) use ($inks) {
+                            foreach($inks as $ink) {                                
+                                $query->whereHas('inks', function($query) use ($ink) {
+                                    $query->where('inks.id', '=', $ink['id']);
+                                });
+                            }
+                        })                      
                         ->when($covers, function ($query, $covers) {
                             $query->whereIn('cover_id', array_column($covers, 'id'));
                         })
@@ -1158,11 +1363,17 @@ function ($query) use (
                     $hand_number_min,
                     $hand_number_max,
                     $scripts,
+                    $scripts_incl,
                     $diacritics,
+                    $diacritics_incl,
                     $punctuations,
+                    $punctuations_incl,
                     $paratexts,
+                    $paratexts_incl,
                     $decorations,
+                    $decorations_incl,
                     $critical_symbols,
+                    $critical_symbols_incl,
                     $paginations,
                     $quire_signatures
                 ) {
@@ -1172,36 +1383,78 @@ function ($query) use (
                         ->when($hand_number_max, function ($query, $hand_number_max) {
                             $query->where('hand_number', '<=', $hand_number_max);
                         })
-                        ->when($scripts, function ($query, $scripts) {
+                        ->when($scripts && !$scripts_incl, function ($query) use ($scripts) {
                             $query->whereHas('scripts', function ($query) use ($scripts) {
                                 $query->whereIn('scripts.id', array_column($scripts, 'id'));
                             });
                         })
-                        ->when($diacritics, function ($query, $diacritics) {
+                        ->when($scripts && $scripts_incl, function ($query) use ($scripts) {
+                            foreach($scripts as $script) {                                
+                                $query->whereHas('scripts', function($query) use ($script) {
+                                    $query->where('scripts.id', '=', $script['id']);
+                                });
+                            }
+                        }) 
+                        ->when($diacritics && !$diacritics_incl, function ($query) use ($diacritics) {
                             $query->whereHas('diacritics', function ($query) use ($diacritics) {
                                 $query->whereIn('diacritics.id', array_column($diacritics, 'id'));
                             });
                         })
-                        ->when($punctuations, function ($query, $punctuations) {
+                        ->when($diacritics && $diacritics_incl, function ($query) use ($diacritics) {
+                            foreach($diacritics as $diacritic) {                                
+                                $query->whereHas('diacritics', function($query) use ($diacritic) {
+                                    $query->where('diacritics.id', '=', $diacritic['id']);
+                                });
+                            }
+                        }) 
+                        ->when($punctuations && !$punctuations_incl, function ($query) use ($punctuations) {
                             $query->whereHas('punctuations', function ($query) use ($punctuations) {
                                 $query->whereIn('punctuations.id', array_column($punctuations, 'id'));
                             });
                         })
-                        ->when($paratexts, function ($query, $paratexts) {
+                        ->when($punctuations && $punctuations_incl, function ($query) use ($punctuations) {
+                            foreach($punctuations as $punctuation) {                                
+                                $query->whereHas('punctuations', function($query) use ($punctuation) {
+                                    $query->where('punctuations.id', '=', $punctuation['id']);
+                                });
+                            }
+                        }) 
+                        ->when($paratexts && !$paratexts_incl, function ($query) use ($paratexts) {
                             $query->whereHas('paratexts', function ($query) use ($paratexts) {
                                 $query->whereIn('paratexts.id', array_column($paratexts, 'id'));
                             });
                         })
-                        ->when($decorations, function ($query, $decorations) {
+                        ->when($paratexts && $paratexts_incl, function ($query) use ($paratexts) {
+                            foreach($paratexts as $paratext) {                                
+                                $query->whereHas('paratexts', function($query) use ($paratext) {
+                                    $query->where('paratexts.id', '=', $paratext['id']);
+                                });
+                            }
+                        }) 
+                        ->when($decorations && !$decorations_incl, function ($query) use ($decorations) {
                             $query->whereHas('decorations', function ($query) use ($decorations) {
                                 $query->whereIn('decorations.id', array_column($decorations, 'id'));
                             });
                         })
-                        ->when($critical_symbols, function ($query, $critical_symbols) {
+                        ->when($decorations && $decorations_incl, function ($query) use ($decorations) {
+                            foreach($decorations as $decoration) {                                
+                                $query->whereHas('decorations', function($query) use ($decoration) {
+                                    $query->where('decorations.id', '=', $decoration['id']);
+                                });
+                            }
+                        }) 
+                        ->when($critical_symbols && !$critical_symbols_incl, function ($query) use ($critical_symbols) {
                             $query->whereHas('critical_symbols', function ($query) use ($critical_symbols) {
                                 $query->whereIn('critical_symbols.id', array_column($critical_symbols, 'id'));
                             });
                         })
+                        ->when($critical_symbols && $critical_symbols_incl, function ($query) use ($critical_symbols) {
+                            foreach($critical_symbols as $critical_symbol) {                                
+                                $query->whereHas('critical_symbols', function($query) use ($critical_symbol) {
+                                    $query->where('critical_symbols.id', '=', $critical_symbol['id']);
+                                });
+                            }
+                        }) 
                         ->when($paginations, function ($query, $paginations) {
                             $query->whereHas('paginations', function ($query) use ($paginations) {
                                 $query->whereIn('paginations.id', array_column($paginations, 'id'));
@@ -1216,15 +1469,23 @@ function ($query) use (
                 $show_consanal == "true",
                 function ($query) use (
                     $storage_conditions,
-                    $analyses
+                    $analyses,
+                    $analyses_incl,
                 ) {
                     $query->when($storage_conditions, function ($query, $storage_conditions) {
                         $query->whereIn('storage_condition_id', array_column($storage_conditions, 'id'));
                     })
-                        ->when($analyses, function ($query, $analyses) {
+                        ->when($analyses && !$analyses_incl, function ($query) use ($analyses) {
                             $query->whereHas('analyses', function ($query) use ($analyses) {
                                 $query->whereIn('analyses.id', array_column($analyses, 'id'));
                             });
+                        })
+                        ->when($analyses && $analyses_incl, function ($query) use ($analyses) {
+                            foreach($analyses as $analysis) {                                
+                                $query->whereHas('analyses', function($query) use ($analysis) {
+                                    $query->where('analyses.id', '=', $analysis['id']);
+                                });
+                            }
                         });
                 }
             )
@@ -1235,7 +1496,9 @@ function ($query) use (
                     $ancient_provenances,
                     $ancient_provenance_certainties,
                     $transactions,
+                    $transactions_incl,
                     $transaction_parties,
+                    $transaction_parties_incl,
                     $legal_classifications
                 ) {
                     $query->when($scientifically_excavated, function ($query, $scientifically_excavated) {
@@ -1247,12 +1510,20 @@ function ($query) use (
                         ->when($ancient_provenance_certainties, function ($query, $ancient_provenance_certainties) {
                             $query->whereIn('ancient_provenance_certainty_id', array_column($ancient_provenance_certainties, 'id'));
                         })
-                        ->when($transactions, function ($query, $transactions) {
+                        ->when($transactions && !$transactions_incl, function ($query) use ($transactions) {
                             $query->whereHas('purchases', function ($query) use ($transactions) {
                                 $query->whereIn('purchases.id', array_column($transactions, 'id'));
                             });
                         })
-                        ->when($transaction_parties, function ($query, $transaction_parties) {
+                        ->when($transactions && $transactions_incl, function ($query) use ($transactions) {
+                            foreach($transactions as $transaction) {                                
+                                $query->whereHas('purchases', function($query) use ($transaction) {
+                                    $query->where('purchases.id', '=', $transaction['id']);
+                                });
+                            }
+                        }) 
+
+                        ->when($transaction_parties && !$transaction_parties_incl, function ($query) use ($transaction_parties) {
                             $tactions = Purchase::query()
                                 ->whereHas('purchase_parties', function ($query) use ($transaction_parties) {
                                     $query->whereIn('purchase_parties.id', array_column($transaction_parties, 'id'));
@@ -1261,14 +1532,24 @@ function ($query) use (
                                 $query->whereIn('purchases.id', array_column($tactions, 'id'));
                             });
                         })
+
+                        ->when($transaction_parties && $transaction_parties_incl, function ($query) use ($transaction_parties) {
+                            
+                            $query->whereHas('purchases', function ($query) use ($transaction_parties) {
+                                foreach($transaction_parties as $transaction_party) {
+                                    $query->whereHas('purchase_parties', function ($query) use ($transaction_party) {
+                                        $query->where('purchase_parties.id', '=', $transaction_party['id']);
+                                    });
+                                }
+                            });
+                        })
                         ->when($legal_classifications, function ($query, $legal_classifications) {
                             $query->whereIn('legal_classification_id', array_column($legal_classifications, 'id'));
                         });
-                }
-            )
+                    })
 
             ->orderBy($sortby, $direction)
-            ->orderBy('end_year', $direction)->get();
+            ->orderBy('end_year', $direction);
 
             $prev = -1;
             $next = -1;
@@ -1338,14 +1619,18 @@ function ($query) use (
             'title' => $title,
             'ancient_author' => $ancient_author,
             'genres_search' => $genres,
+            'genres_incl' => $genres_incl,
             'tags_search' => $tags,
+            'tags_incl' => $tags_incl,
             'earliest_date' => $earliest_date,
             'latest_date' => $latest_date,
             'exclusive_date' => $exclusive_date == "true" ? true : false,
             'dating_methods_search' => $dating_methods,
+            'dating_methods_incl' => $dating_methods_incl,
             'dating_certainties_search' => $dating_certainties,
             'materials_search' => $materials,
             'inks_search' => $inks,
+            'inks_incl' => $inks_incl == "true" ? true : false,
             'covers_search' => $covers,
             'quire_structures_search' => $quire_structures,
             'quirenum_min' => $quirenum_min,
@@ -1371,20 +1656,29 @@ function ($query) use (
             'hand_number_min' => $hand_number_min,
             'hand_number_max' => $hand_number_max,
             'scripts_search' => $scripts,
+            'scripts_incl' => $scripts_incl,
             'diacritics_search' => $diacritics,
+            'diacritics_incl' => $diacritics_incl,
             'punctuations_search' => $punctuations,
+            'punctuations_incl' => $punctuations_incl,
             'paratexts_search' => $paratexts,
+            'paratexts_incl' => $paratexts_incl,
             'decorations_search' => $decorations,
+            'decorations_incl' => $decorations_incl,
             'critical_symbols_search' => $critical_symbols,
+            'critical_symbols_incl' => $critical_symbols_incl,
             'paginations_search' => $paginations,
             'quire_signatures_search' => $quire_signatures,
             'storage_conditions_search' => $storage_conditions,
             'analyses_search' => $analyses,
+            'analyses_incl' => $analyses_incl,
             'scientifically_excavated' => $scientifically_excavated,
             'ancient_provenances_search' => $ancient_provenances,
             'ancient_provenance_certainties_search' => $ancient_provenance_certainties,
             'transactions_search' => $transactions,
+            'transactions_incl' => $transactions_incl,
             'transaction_parties_search' => $transaction_parties,
+            'transaction_parties_incl' => $transaction_parties_incl,
             'legal_classifications_search' => $legal_classifications,
 
             'sortfield' => $sortfield,
@@ -1421,14 +1715,18 @@ public function edit(Document $document, Request $request)
             's_title' => 'nullable',
             's_ancient_author' => 'nullable',
             's_genres' => 'nullable',
+            's_genres_incl' => 'nullable',
             's_tags' => 'nullable',
+            's_tags_incl' => 'nullable',
             's_earliest_date' => 'nullable',
             's_latest_date' => 'nullable',
             's_exclusive_date' => 'nullable',
             's_dating_methods' => 'nullable',
+            's_dating_methods_incl' => 'nullable',
             's_dating_certainties' => 'nullable',
             's_materials' => 'nullable',
             's_inks' => 'nullable',
+            's_inks_incl' => 'nullable',
             's_covers' => 'nullable',
             's_quire_structures' => 'nullable',
             's_quirenum_min' => 'nullable',
@@ -1454,20 +1752,29 @@ public function edit(Document $document, Request $request)
             's_hand_number_min' => 'nullable',
             's_hand_number_max' => 'nullable',
             's_scripts' => 'nullable',
+            's_scripts_incl' => 'nullable',
             's_diacritics' => 'nullable',
+            's_diacritics_incl' => 'nullable',
             's_punctuations' => 'nullable',
+            's_punctuations_incl' => 'nullable',
             's_paratexts' => 'nullable',
+            's_paratexts_incl' => 'nullable',
             's_decorations' => 'nullable',
+            's_decorations_incl' => 'nullable',
             's_critical_symbols' => 'nullable',
+            's_critical_symbols_incl' => 'nullable',
             's_paginations' => 'nullable',
             's_quire_signatures' => 'nullable',
             's_storage_conditions' => 'nullable',
             's_analyses' => 'nullable',
+            's_analyses_incl' => 'nullable',
             's_scientifically_excavated' => 'nullable',
             's_ancient_provenances' => 'nullable',
             's_ancient_provenance_certainties' => 'nullable',
             's_transactions' => 'nullable',
+            's_transactions_incl' => 'nullable',
             's_transaction_parties' => 'nullable',
+            's_transaction_parties_incl' => 'nullable',
             's_legal_classifications' => 'nullable',
             'sortfield' => 'nullable',
             'reverse' => 'nullable',
@@ -1523,14 +1830,18 @@ public function edit(Document $document, Request $request)
         $title = array_key_exists('s_title', $search) ? $search['s_title'] : null;
         $ancient_author = array_key_exists('s_ancient_author', $search) ? $search['s_ancient_author'] : null;
         $genres = array_key_exists('s_genres', $search) ? $search['s_genres'] : null;
+        $genres_incl = array_key_exists('s_genres_incl', $search) ? $search['s_genres_incl'] : null;
         $tags = array_key_exists('s_tags', $search) ? $search['s_tags'] : null;
+        $tags_incl = array_key_exists('s_tags_incl', $search) ? $search['s_tags_incl'] : null;
         $earliest_date = array_key_exists('s_earliest_date', $search) ? $search['s_earliest_date'] : null;
         $latest_date = array_key_exists('s_latest_date', $search) ? $search['s_latest_date'] : null;
         $exclusive_date = array_key_exists('s_exclusive_date', $search) ? $search['s_exclusive_date'] : false;
         $dating_methods = array_key_exists('s_dating_methods', $search) ? $search['s_dating_methods'] : null;
+        $dating_methods_incl = array_key_exists('s_dating_methods_incl', $search) ? $search['s_dating_methods_incl'] : null;
         $dating_certainties = array_key_exists('s_dating_certainties', $search) ? $search['s_dating_certainties'] : null;
         $materials = array_key_exists('s_materials', $search) ? $search['s_materials'] : null;
         $inks = array_key_exists('s_inks', $search) ? $search['s_inks'] : null;
+        $inks_incl = array_key_exists('s_inks_incl', $search) ? $search['s_inks_incl'] : null;
         $covers = array_key_exists('s_covers', $search) ? $search['s_covers'] : null;
         $quire_structures = array_key_exists('s_quire_structures', $search) ? $search['s_quire_structures'] : null;
         $quirenum_min = array_key_exists('s_quirenum_min', $search) ? $search['s_quirenum_min'] : null;
@@ -1556,20 +1867,29 @@ public function edit(Document $document, Request $request)
         $hand_number_min = array_key_exists('s_hand_number_min', $search) ? $search['s_hand_number_min'] : null;
         $hand_number_max = array_key_exists('s_hand_number_max', $search) ? $search['s_hand_number_max'] : null;
         $scripts = array_key_exists('s_scripts', $search) ? $search['s_scripts'] : null;
+        $scripts_incl = array_key_exists('s_scripts_incl', $search) ? $search['s_scripts_incl'] : null;
         $diacritics = array_key_exists('s_diacritics', $search) ? $search['s_diacritics'] : null;
+        $diacritics_incl = array_key_exists('s_diacritics_incl', $search) ? $search['s_diacritics_incl'] : null;
         $punctuations = array_key_exists('s_punctuations', $search) ? $search['s_punctuations'] : null;
+        $punctuations_incl = array_key_exists('s_punctuations_incl', $search) ? $search['s_punctuations_incl'] : null;
         $paratexts = array_key_exists('s_paratexts', $search) ? $search['s_paratexts'] : null;
+        $paratexts_incl = array_key_exists('s_paratexts_incl', $search) ? $search['s_paratexts_incl'] : null;
         $decorations = array_key_exists('s_decorations', $search) ? $search['s_decorations'] : null;
+        $decorations_incl = array_key_exists('s_decorations_incl', $search) ? $search['s_decorations_incl'] : null;
         $critical_symbols = array_key_exists('s_critical_symbols', $search) ? $search['s_critical_symbols'] : null;
+        $critical_symbols_incl = array_key_exists('s_critical_symbols_incl', $search) ? $search['s_critical_symbols_incl'] : null;
         $paginations = array_key_exists('s_pagination', $search) ? $search['s_paginations'] : null;
         $quire_signatures = array_key_exists('s_quire_signatures', $search) ? $search['s_quire_signatures'] : null;
         $storage_conditions = array_key_exists('s_storage_conditions', $search) ? $search['s_storage_conditions'] : null;
         $analyses = array_key_exists('s_analyses', $search) ? $search['s_analyses'] : null;
+        $analyses_incl = array_key_exists('s_analyses_incl', $search) ? $search['s_analyses_incl'] : null;
         $scientifically_excavated = array_key_exists('s_scientifically_excavated', $search) ? $search['s_scientifically_excavated'] : null;
         $ancient_provenances = array_key_exists('s_ancient_provenances', $search) ? $search['s_ancient_provenances'] : null;
         $ancient_provenance_certainties = array_key_exists('s_ancient_provenance_certainties', $search) ? $search['s_ancient_provenance_certainties'] : null;
         $transactions = array_key_exists('s_transactions', $search) ? $search['s_transactions'] : null;
+        $transactions_incl = array_key_exists('s_transactions_incl', $search) ? $search['s_transactions_incl'] : null;
         $transaction_parties = array_key_exists('s_transaction_parties', $search) ? $search['s_transaction_parties'] : null;
+        $transaction_parties_incl = array_key_exists('s_transaction_parties_incl', $search) ? $search['s_transaction_parties_incl'] : null;
         $legal_classifications = array_key_exists('s_legal_classifications', $search) ? $search['s_legal_classifications'] : null;
         
         if($show_provenance AND $ancient_provenances) {
@@ -1592,9 +1912,9 @@ public function edit(Document $document, Request $request)
         $all_documents = Document::query()
             ->when($role_id < 2, function ($query) {
                 $query->where('published', '=', true);
-            })
-            ->when($fulltext, function ($query, $fulltext) {
-                $query->where(function ($query) use ($fulltext) {
+            }) 
+            ->when($fulltext, function ($query) use ($fulltext, $role_id) {
+                $query->where(function ($query) use ($fulltext, $role_id) {
                     $query->where('standard_name', 'like', "%{$fulltext}%")
                         ->orWhere('standard_name', 'like', "%{$fulltext}%")
                         ->orWhere('other_names', 'like', "%{$fulltext}%")
@@ -1628,7 +1948,7 @@ public function edit(Document $document, Request $request)
                         ->orWhere('bibliography', 'like', "%{$fulltext}%")
                         ->orWhere('images_info', 'like', "%{$fulltext}%")
                         ->orWhere('excavation_comment', 'like', "%{$fulltext}%")
-                        ->orWhere('internal_comment', 'like', "%{$fulltext}%");
+                        ->orWhere('internal_comment', 'like', $role_id >= 2 ? "%{$fulltext}%" : "notsomethinganyonewouldwrite");
                 });
             })
             ->when($show_publication == "true", function ($query) use (
@@ -1654,7 +1974,9 @@ public function edit(Document $document, Request $request)
                 $title,
                 $ancient_author,
                 $genres,
-                $tags
+                $genres_incl,
+                $tags,
+                $tags_incl,
             ) {
                 $query->when($title, function ($query, $title) {
                     $query->where('title', 'like', "%{$title}%");
@@ -1662,22 +1984,37 @@ public function edit(Document $document, Request $request)
                     ->when($ancient_author, function ($query, $ancient_author) {
                         $query->where('ancient_author', 'like', "%{$ancient_author}%");
                     })
-                    ->when($genres, function ($query, $genres) {
+                    ->when($genres && !$genres_incl, function ($query) use ($genres) {
                         $query->whereHas('genres', function ($query) use ($genres) {
                             $query->whereIn('genres.id', array_column($genres, 'id'));
                         });
                     })
-                    ->when($tags, function ($query, $tags) {
+                    ->when($genres && $genres_incl, function ($query) use ($genres) {
+                        foreach($genres as $genre) {                                
+                            $query->whereHas('genres', function($query) use ($genre) {
+                                $query->where('genres.id', '=', $genre['id']);
+                            });
+                        }
+                    }) 
+                    ->when($tags && !$tags_incl, function ($query) use ($tags) {
                         $query->whereHas('tags', function ($query) use ($tags) {
                             $query->whereIn('tags.id', array_column($tags, 'id'));
                         });
-                    });
+                    })
+                    ->when($tags && $tags_incl, function ($query) use ($tags) {
+                        foreach($tags as $tag) {                                
+                            $query->whereHas('tags', function($query) use ($tag) {
+                                $query->where('tags.id', '=', $tag['id']);
+                            });
+                        }
+                    }); 
             })
             ->when($show_dating == "true", function ($query) use (
                 $earliest_date,
                 $latest_date,
                 $exclusive_date,
                 $dating_methods,
+                $dating_methods_incl,
                 $dating_certainties
             ) {
                 $query->when($exclusive_date == "true", function ($query) use ($earliest_date, $latest_date, $exclusive_date) {
@@ -1695,11 +2032,18 @@ public function edit(Document $document, Request $request)
                             $query->where('start_year', '<=', $latest_date);
                         });
                 })
-                    ->when($dating_methods, function ($query, $dating_methods) {
+                    ->when($dating_methods && !$dating_methods_incl, function ($query) use ($dating_methods) {
                         $query->whereHas('dating_methods', function ($query) use ($dating_methods) {
                             $query->whereIn('dating_methods.id', array_column($dating_methods, 'id'));
                         });
                     })
+                    ->when($dating_methods && $dating_methods_incl, function ($query) use ($dating_methods) {
+                        foreach($dating_methods as $dating_method) {                                
+                            $query->whereHas('dating_methods', function($query) use ($dating_method) {
+                                $query->where('dating_methods.id', '=', $dating_method['id']);
+                            });
+                        }
+                    }) 
                     ->when($dating_certainties, function ($query, $dating_certainties) {
                         $query->whereIn('dating_certainty_id', array_column($dating_certainties, 'id'));
                     });
@@ -1709,6 +2053,7 @@ public function edit(Document $document, Request $request)
                 function ($query) use (
                     $materials,
                     $inks,
+                    $inks_incl,
                     $covers,
                     $quire_structures,
                     $quirenum_min,
@@ -1716,14 +2061,21 @@ function ($query) use (
                     $bifolianum_min,
                     $bifolianum_max
                 ) {
-                    $query->when($materials, function ($query, $materials) {
-                        $query->whereIn('material_id', array_column($materials, 'id'));
-                    })
-                        ->when($inks, function ($query, $inks) {
+                        $query->when($materials, function ($query, $materials) {
+                            $query->whereIn('material_id', array_column($materials, 'id'));
+                        })
+                        ->when(($inks && !$inks_incl), function ($query) use ($inks) {
                             $query->whereHas('inks', function ($query) use ($inks) {
                                 $query->whereIn('inks.id', array_column($inks, 'id'));
                             });
                         })
+                        ->when($inks && $inks_incl, function ($query) use ($inks) {
+                            foreach($inks as $ink) {                                
+                                $query->whereHas('inks', function($query) use ($ink) {
+                                    $query->where('inks.id', '=', $ink['id']);
+                                });
+                            }
+                        })                      
                         ->when($covers, function ($query, $covers) {
                             $query->whereIn('cover_id', array_column($covers, 'id'));
                         })
@@ -1821,11 +2173,17 @@ function ($query) use (
                     $hand_number_min,
                     $hand_number_max,
                     $scripts,
+                    $scripts_incl,
                     $diacritics,
+                    $diacritics_incl,
                     $punctuations,
+                    $punctuations_incl,
                     $paratexts,
+                    $paratexts_incl,
                     $decorations,
+                    $decorations_incl,
                     $critical_symbols,
+                    $critical_symbols_incl,
                     $paginations,
                     $quire_signatures
                 ) {
@@ -1835,36 +2193,78 @@ function ($query) use (
                         ->when($hand_number_max, function ($query, $hand_number_max) {
                             $query->where('hand_number', '<=', $hand_number_max);
                         })
-                        ->when($scripts, function ($query, $scripts) {
+                        ->when($scripts && !$scripts_incl, function ($query) use ($scripts) {
                             $query->whereHas('scripts', function ($query) use ($scripts) {
                                 $query->whereIn('scripts.id', array_column($scripts, 'id'));
                             });
                         })
-                        ->when($diacritics, function ($query, $diacritics) {
+                        ->when($scripts && $scripts_incl, function ($query) use ($scripts) {
+                            foreach($scripts as $script) {                                
+                                $query->whereHas('scripts', function($query) use ($script) {
+                                    $query->where('scripts.id', '=', $script['id']);
+                                });
+                            }
+                        }) 
+                        ->when($diacritics && !$diacritics_incl, function ($query) use ($diacritics) {
                             $query->whereHas('diacritics', function ($query) use ($diacritics) {
                                 $query->whereIn('diacritics.id', array_column($diacritics, 'id'));
                             });
                         })
-                        ->when($punctuations, function ($query, $punctuations) {
+                        ->when($diacritics && $diacritics_incl, function ($query) use ($diacritics) {
+                            foreach($diacritics as $diacritic) {                                
+                                $query->whereHas('diacritics', function($query) use ($diacritic) {
+                                    $query->where('diacritics.id', '=', $diacritic['id']);
+                                });
+                            }
+                        }) 
+                        ->when($punctuations && !$punctuations_incl, function ($query) use ($punctuations) {
                             $query->whereHas('punctuations', function ($query) use ($punctuations) {
                                 $query->whereIn('punctuations.id', array_column($punctuations, 'id'));
                             });
                         })
-                        ->when($paratexts, function ($query, $paratexts) {
+                        ->when($punctuations && $punctuations_incl, function ($query) use ($punctuations) {
+                            foreach($punctuations as $punctuation) {                                
+                                $query->whereHas('punctuations', function($query) use ($punctuation) {
+                                    $query->where('punctuations.id', '=', $punctuation['id']);
+                                });
+                            }
+                        }) 
+                        ->when($paratexts && !$paratexts_incl, function ($query) use ($paratexts) {
                             $query->whereHas('paratexts', function ($query) use ($paratexts) {
                                 $query->whereIn('paratexts.id', array_column($paratexts, 'id'));
                             });
                         })
-                        ->when($decorations, function ($query, $decorations) {
+                        ->when($paratexts && $paratexts_incl, function ($query) use ($paratexts) {
+                            foreach($paratexts as $paratext) {                                
+                                $query->whereHas('paratexts', function($query) use ($paratext) {
+                                    $query->where('paratexts.id', '=', $paratext['id']);
+                                });
+                            }
+                        }) 
+                        ->when($decorations && !$decorations_incl, function ($query) use ($decorations) {
                             $query->whereHas('decorations', function ($query) use ($decorations) {
                                 $query->whereIn('decorations.id', array_column($decorations, 'id'));
                             });
                         })
-                        ->when($critical_symbols, function ($query, $critical_symbols) {
+                        ->when($decorations && $decorations_incl, function ($query) use ($decorations) {
+                            foreach($decorations as $decoration) {                                
+                                $query->whereHas('decorations', function($query) use ($decoration) {
+                                    $query->where('decorations.id', '=', $decoration['id']);
+                                });
+                            }
+                        }) 
+                        ->when($critical_symbols && !$critical_symbols_incl, function ($query) use ($critical_symbols) {
                             $query->whereHas('critical_symbols', function ($query) use ($critical_symbols) {
                                 $query->whereIn('critical_symbols.id', array_column($critical_symbols, 'id'));
                             });
                         })
+                        ->when($critical_symbols && $critical_symbols_incl, function ($query) use ($critical_symbols) {
+                            foreach($critical_symbols as $critical_symbol) {                                
+                                $query->whereHas('critical_symbols', function($query) use ($critical_symbol) {
+                                    $query->where('critical_symbols.id', '=', $critical_symbol['id']);
+                                });
+                            }
+                        }) 
                         ->when($paginations, function ($query, $paginations) {
                             $query->whereHas('paginations', function ($query) use ($paginations) {
                                 $query->whereIn('paginations.id', array_column($paginations, 'id'));
@@ -1879,15 +2279,23 @@ function ($query) use (
                 $show_consanal == "true",
                 function ($query) use (
                     $storage_conditions,
-                    $analyses
+                    $analyses,
+                    $analyses_incl,
                 ) {
                     $query->when($storage_conditions, function ($query, $storage_conditions) {
                         $query->whereIn('storage_condition_id', array_column($storage_conditions, 'id'));
                     })
-                        ->when($analyses, function ($query, $analyses) {
+                        ->when($analyses && !$analyses_incl, function ($query) use ($analyses) {
                             $query->whereHas('analyses', function ($query) use ($analyses) {
                                 $query->whereIn('analyses.id', array_column($analyses, 'id'));
                             });
+                        })
+                        ->when($analyses && $analyses_incl, function ($query) use ($analyses) {
+                            foreach($analyses as $analysis) {                                
+                                $query->whereHas('analyses', function($query) use ($analysis) {
+                                    $query->where('analyses.id', '=', $analysis['id']);
+                                });
+                            }
                         });
                 }
             )
@@ -1898,7 +2306,9 @@ function ($query) use (
                     $ancient_provenances,
                     $ancient_provenance_certainties,
                     $transactions,
+                    $transactions_incl,
                     $transaction_parties,
+                    $transaction_parties_incl,
                     $legal_classifications
                 ) {
                     $query->when($scientifically_excavated, function ($query, $scientifically_excavated) {
@@ -1910,12 +2320,20 @@ function ($query) use (
                         ->when($ancient_provenance_certainties, function ($query, $ancient_provenance_certainties) {
                             $query->whereIn('ancient_provenance_certainty_id', array_column($ancient_provenance_certainties, 'id'));
                         })
-                        ->when($transactions, function ($query, $transactions) {
+                        ->when($transactions && !$transactions_incl, function ($query) use ($transactions) {
                             $query->whereHas('purchases', function ($query) use ($transactions) {
                                 $query->whereIn('purchases.id', array_column($transactions, 'id'));
                             });
                         })
-                        ->when($transaction_parties, function ($query, $transaction_parties) {
+                        ->when($transactions && $transactions_incl, function ($query) use ($transactions) {
+                            foreach($transactions as $transaction) {                                
+                                $query->whereHas('purchases', function($query) use ($transaction) {
+                                    $query->where('purchases.id', '=', $transaction['id']);
+                                });
+                            }
+                        }) 
+
+                        ->when($transaction_parties && !$transaction_parties_incl, function ($query) use ($transaction_parties) {
                             $tactions = Purchase::query()
                                 ->whereHas('purchase_parties', function ($query) use ($transaction_parties) {
                                     $query->whereIn('purchase_parties.id', array_column($transaction_parties, 'id'));
@@ -1924,14 +2342,24 @@ function ($query) use (
                                 $query->whereIn('purchases.id', array_column($tactions, 'id'));
                             });
                         })
+
+                        ->when($transaction_parties && $transaction_parties_incl, function ($query) use ($transaction_parties) {
+                            
+                            $query->whereHas('purchases', function ($query) use ($transaction_parties) {
+                                foreach($transaction_parties as $transaction_party) {
+                                    $query->whereHas('purchase_parties', function ($query) use ($transaction_party) {
+                                        $query->where('purchase_parties.id', '=', $transaction_party['id']);
+                                    });
+                                }
+                            });
+                        })
                         ->when($legal_classifications, function ($query, $legal_classifications) {
                             $query->whereIn('legal_classification_id', array_column($legal_classifications, 'id'));
                         });
-                }
-            )
+                    })
 
             ->orderBy($sortby, $direction)
-            ->orderBy('end_year', $direction)->get();
+            ->orderBy('end_year', $direction);
 
             $prev = -1;
             $next = -1;
@@ -2026,14 +2454,18 @@ function ($query) use (
             'title' => $title,
             'ancient_author' => $ancient_author,
             'genres_search' => $genres,
+            'genres_incl' => $genres_incl,
             'tags_search' => $tags,
+            'tags_incl' => $tags_incl,
             'earliest_date' => $earliest_date,
             'latest_date' => $latest_date,
             'exclusive_date' => $exclusive_date == "true" ? true : false,
             'dating_methods_search' => $dating_methods,
+            'dating_methods_incl' => $dating_methods_incl,
             'dating_certainties_search' => $dating_certainties,
             'materials_search' => $materials,
             'inks_search' => $inks,
+            'inks_incl' => $inks_incl == "true" ? true : false,
             'covers_search' => $covers,
             'quire_structures_search' => $quire_structures,
             'quirenum_min' => $quirenum_min,
@@ -2059,20 +2491,29 @@ function ($query) use (
             'hand_number_min' => $hand_number_min,
             'hand_number_max' => $hand_number_max,
             'scripts_search' => $scripts,
+            'scripts_incl' => $scripts_incl,
             'diacritics_search' => $diacritics,
+            'diacritics_incl' => $diacritics_incl,
             'punctuations_search' => $punctuations,
+            'punctuations_incl' => $punctuations_incl,
             'paratexts_search' => $paratexts,
+            'paratexts_incl' => $paratexts_incl,
             'decorations_search' => $decorations,
+            'decorations_incl' => $decorations_incl,
             'critical_symbols_search' => $critical_symbols,
+            'critical_symbols_incl' => $critical_symbols_incl,
             'paginations_search' => $paginations,
             'quire_signatures_search' => $quire_signatures,
             'storage_conditions_search' => $storage_conditions,
             'analyses_search' => $analyses,
+            'analyses_incl' => $analyses_incl,
             'scientifically_excavated' => $scientifically_excavated,
             'ancient_provenances_search' => $ancient_provenances,
             'ancient_provenance_certainties_search' => $ancient_provenance_certainties,
             'transactions_search' => $transactions,
+            'transactions_incl' => $transactions_incl,
             'transaction_parties_search' => $transaction_parties,
+            'transaction_parties_incl' => $transaction_parties_incl,
             'legal_classifications_search' => $legal_classifications,
 
             'sortfield' => $sortfield,
@@ -2116,14 +2557,18 @@ public function update(Request $request, Document $document)
             's_title' => 'nullable',
             's_ancient_author' => 'nullable',
             's_genres' => 'nullable',
+            's_genres_incl' => 'nullable',
             's_tags' => 'nullable',
+            's_tags_incl' => 'nullable',
             's_earliest_date' => 'nullable',
             's_latest_date' => 'nullable',
             's_exclusive_date' => 'nullable',
             's_dating_methods' => 'nullable',
+            's_dating_methods_incl' => 'nullable',
             's_dating_certainties' => 'nullable',
             's_materials' => 'nullable',
             's_inks' => 'nullable',
+            's_inks_incl' => 'nullable',
             's_covers' => 'nullable',
             's_quire_structures' => 'nullable',
             's_quirenum_min' => 'nullable',
@@ -2149,20 +2594,29 @@ public function update(Request $request, Document $document)
             's_hand_number_min' => 'nullable',
             's_hand_number_max' => 'nullable',
             's_scripts' => 'nullable',
+            's_scripts_incl' => 'nullable',
             's_diacritics' => 'nullable',
+            's_diacritics_incl' => 'nullable',
             's_punctuations' => 'nullable',
+            's_punctuations_incl' => 'nullable',
             's_paratexts' => 'nullable',
+            's_paratexts_incl' => 'nullable',
             's_decorations' => 'nullable',
+            's_decorations_incl' => 'nullable',
             's_critical_symbols' => 'nullable',
+            's_critical_symbols_incl' => 'nullable',
             's_paginations' => 'nullable',
             's_quire_signatures' => 'nullable',
             's_storage_conditions' => 'nullable',
             's_analyses' => 'nullable',
+            's_analyses_incl' => 'nullable',
             's_scientifically_excavated' => 'nullable',
             's_ancient_provenances' => 'nullable',
             's_ancient_provenance_certainties' => 'nullable',
             's_transactions' => 'nullable',
+            's_transactions_incl' => 'nullable',
             's_transaction_parties' => 'nullable',
+            's_transaction_parties_incl' => 'nullable',
             's_legal_classifications' => 'nullable',
             'sortfield' => 'nullable',
             'reverse' => 'nullable',
@@ -2219,14 +2673,18 @@ public function update(Request $request, Document $document)
         $title = array_key_exists('s_title', $search) ? $search['s_title'] : null;
         $ancient_author = array_key_exists('s_ancient_author', $search) ? $search['s_ancient_author'] : null;
         $genres = array_key_exists('s_genres', $search) ? $search['s_genres'] : null;
+        $genres_incl = array_key_exists('s_genres_incl', $search) ? $search['s_genres_incl'] : null;
         $tags = array_key_exists('s_tags', $search) ? $search['s_tags'] : null;
+        $tags_incl = array_key_exists('s_tags_incl', $search) ? $search['s_tags_incl'] : null;
         $earliest_date = array_key_exists('s_earliest_date', $search) ? $search['s_earliest_date'] : null;
         $latest_date = array_key_exists('s_latest_date', $search) ? $search['s_latest_date'] : null;
         $exclusive_date = array_key_exists('s_exclusive_date', $search) ? $search['s_exclusive_date'] : false;
         $dating_methods = array_key_exists('s_dating_methods', $search) ? $search['s_dating_methods'] : null;
+        $dating_methods_incl = array_key_exists('s_dating_methods_incl', $search) ? $search['s_dating_methods_incl'] : null;
         $dating_certainties = array_key_exists('s_dating_certainties', $search) ? $search['s_dating_certainties'] : null;
         $materials = array_key_exists('s_materials', $search) ? $search['s_materials'] : null;
         $inks = array_key_exists('s_inks', $search) ? $search['s_inks'] : null;
+        $inks_incl = array_key_exists('s_inks_incl', $search) ? $search['s_inks_incl'] : null;
         $covers = array_key_exists('s_covers', $search) ? $search['s_covers'] : null;
         $quire_structures = array_key_exists('s_quire_structures', $search) ? $search['s_quire_structures'] : null;
         $quirenum_min = array_key_exists('s_quirenum_min', $search) ? $search['s_quirenum_min'] : null;
@@ -2252,20 +2710,29 @@ public function update(Request $request, Document $document)
         $hand_number_min = array_key_exists('s_hand_number_min', $search) ? $search['s_hand_number_min'] : null;
         $hand_number_max = array_key_exists('s_hand_number_max', $search) ? $search['s_hand_number_max'] : null;
         $scripts = array_key_exists('s_scripts', $search) ? $search['s_scripts'] : null;
+        $scripts_incl = array_key_exists('s_scripts_incl', $search) ? $search['s_scripts_incl'] : null;
         $diacritics = array_key_exists('s_diacritics', $search) ? $search['s_diacritics'] : null;
+        $diacritics_incl = array_key_exists('s_diacritics_incl', $search) ? $search['s_diacritics_incl'] : null;
         $punctuations = array_key_exists('s_punctuations', $search) ? $search['s_punctuations'] : null;
+        $punctuations_incl = array_key_exists('s_punctuations_incl', $search) ? $search['s_punctuations_incl'] : null;
         $paratexts = array_key_exists('s_paratexts', $search) ? $search['s_paratexts'] : null;
+        $paratexts_incl = array_key_exists('s_paratexts_incl', $search) ? $search['s_paratexts_incl'] : null;
         $decorations = array_key_exists('s_decorations', $search) ? $search['s_decorations'] : null;
+        $decorations_incl = array_key_exists('s_decorations_incl', $search) ? $search['s_decorations_incl'] : null;
         $critical_symbols = array_key_exists('s_critical_symbols', $search) ? $search['s_critical_symbols'] : null;
+        $critical_symbols_incl = array_key_exists('s_critical_symbols_incl', $search) ? $search['s_critical_symbols_incl'] : null;
         $paginations = array_key_exists('s_pagination', $search) ? $search['s_paginations'] : null;
         $quire_signatures = array_key_exists('s_quire_signatures', $search) ? $search['s_quire_signatures'] : null;
         $storage_conditions = array_key_exists('s_storage_conditions', $search) ? $search['s_storage_conditions'] : null;
         $analyses = array_key_exists('s_analyses', $search) ? $search['s_analyses'] : null;
+        $analyses_incl = array_key_exists('s_analyses_incl', $search) ? $search['s_analyses_incl'] : null;
         $scientifically_excavated = array_key_exists('s_scientifically_excavated', $search) ? $search['s_scientifically_excavated'] : null;
         $ancient_provenances = array_key_exists('s_ancient_provenances', $search) ? $search['s_ancient_provenances'] : null;
         $ancient_provenance_certainties = array_key_exists('s_ancient_provenance_certainties', $search) ? $search['s_ancient_provenance_certainties'] : null;
         $transactions = array_key_exists('s_transactions', $search) ? $search['s_transactions'] : null;
+        $transactions_incl = array_key_exists('s_transactions_incl', $search) ? $search['s_transactions_incl'] : null;
         $transaction_parties = array_key_exists('s_transaction_parties', $search) ? $search['s_transaction_parties'] : null;
+        $transaction_parties_incl = array_key_exists('s_transaction_parties_incl', $search) ? $search['s_transaction_parties_incl'] : null;
         $legal_classifications = array_key_exists('s_legal_classifications', $search) ? $search['s_legal_classifications'] : null;
         
         if($show_provenance AND $ancient_provenances) {
@@ -2288,9 +2755,9 @@ public function update(Request $request, Document $document)
         $all_documents = Document::query()
             ->when($role_id < 2, function ($query) {
                 $query->where('published', '=', true);
-            })
-            ->when($fulltext, function ($query, $fulltext) {
-                $query->where(function ($query) use ($fulltext) {
+            }) 
+            ->when($fulltext, function ($query) use ($fulltext, $role_id) {
+                $query->where(function ($query) use ($fulltext, $role_id) {
                     $query->where('standard_name', 'like', "%{$fulltext}%")
                         ->orWhere('standard_name', 'like', "%{$fulltext}%")
                         ->orWhere('other_names', 'like', "%{$fulltext}%")
@@ -2324,7 +2791,7 @@ public function update(Request $request, Document $document)
                         ->orWhere('bibliography', 'like', "%{$fulltext}%")
                         ->orWhere('images_info', 'like', "%{$fulltext}%")
                         ->orWhere('excavation_comment', 'like', "%{$fulltext}%")
-                        ->orWhere('internal_comment', 'like', "%{$fulltext}%");
+                        ->orWhere('internal_comment', 'like', $role_id >= 2 ? "%{$fulltext}%" : "notsomethinganyonewouldwrite");
                 });
             })
             ->when($show_publication == "true", function ($query) use (
@@ -2350,7 +2817,9 @@ public function update(Request $request, Document $document)
                 $title,
                 $ancient_author,
                 $genres,
-                $tags
+                $genres_incl,
+                $tags,
+                $tags_incl,
             ) {
                 $query->when($title, function ($query, $title) {
                     $query->where('title', 'like', "%{$title}%");
@@ -2358,22 +2827,37 @@ public function update(Request $request, Document $document)
                     ->when($ancient_author, function ($query, $ancient_author) {
                         $query->where('ancient_author', 'like', "%{$ancient_author}%");
                     })
-                    ->when($genres, function ($query, $genres) {
+                    ->when($genres && !$genres_incl, function ($query) use ($genres) {
                         $query->whereHas('genres', function ($query) use ($genres) {
                             $query->whereIn('genres.id', array_column($genres, 'id'));
                         });
                     })
-                    ->when($tags, function ($query, $tags) {
+                    ->when($genres && $genres_incl, function ($query) use ($genres) {
+                        foreach($genres as $genre) {                                
+                            $query->whereHas('genres', function($query) use ($genre) {
+                                $query->where('genres.id', '=', $genre['id']);
+                            });
+                        }
+                    }) 
+                    ->when($tags && !$tags_incl, function ($query) use ($tags) {
                         $query->whereHas('tags', function ($query) use ($tags) {
                             $query->whereIn('tags.id', array_column($tags, 'id'));
                         });
-                    });
+                    })
+                    ->when($tags && $tags_incl, function ($query) use ($tags) {
+                        foreach($tags as $tag) {                                
+                            $query->whereHas('tags', function($query) use ($tag) {
+                                $query->where('tags.id', '=', $tag['id']);
+                            });
+                        }
+                    }); 
             })
             ->when($show_dating == "true", function ($query) use (
                 $earliest_date,
                 $latest_date,
                 $exclusive_date,
                 $dating_methods,
+                $dating_methods_incl,
                 $dating_certainties
             ) {
                 $query->when($exclusive_date == "true", function ($query) use ($earliest_date, $latest_date, $exclusive_date) {
@@ -2391,11 +2875,18 @@ public function update(Request $request, Document $document)
                             $query->where('start_year', '<=', $latest_date);
                         });
                 })
-                    ->when($dating_methods, function ($query, $dating_methods) {
+                    ->when($dating_methods && !$dating_methods_incl, function ($query) use ($dating_methods) {
                         $query->whereHas('dating_methods', function ($query) use ($dating_methods) {
                             $query->whereIn('dating_methods.id', array_column($dating_methods, 'id'));
                         });
                     })
+                    ->when($dating_methods && $dating_methods_incl, function ($query) use ($dating_methods) {
+                        foreach($dating_methods as $dating_method) {                                
+                            $query->whereHas('dating_methods', function($query) use ($dating_method) {
+                                $query->where('dating_methods.id', '=', $dating_method['id']);
+                            });
+                        }
+                    }) 
                     ->when($dating_certainties, function ($query, $dating_certainties) {
                         $query->whereIn('dating_certainty_id', array_column($dating_certainties, 'id'));
                     });
@@ -2405,6 +2896,7 @@ public function update(Request $request, Document $document)
                 function ($query) use (
                     $materials,
                     $inks,
+                    $inks_incl,
                     $covers,
                     $quire_structures,
                     $quirenum_min,
@@ -2412,14 +2904,21 @@ function ($query) use (
                     $bifolianum_min,
                     $bifolianum_max
                 ) {
-                    $query->when($materials, function ($query, $materials) {
-                        $query->whereIn('material_id', array_column($materials, 'id'));
-                    })
-                        ->when($inks, function ($query, $inks) {
+                        $query->when($materials, function ($query, $materials) {
+                            $query->whereIn('material_id', array_column($materials, 'id'));
+                        })
+                        ->when(($inks && !$inks_incl), function ($query) use ($inks) {
                             $query->whereHas('inks', function ($query) use ($inks) {
                                 $query->whereIn('inks.id', array_column($inks, 'id'));
                             });
                         })
+                        ->when($inks && $inks_incl, function ($query) use ($inks) {
+                            foreach($inks as $ink) {                                
+                                $query->whereHas('inks', function($query) use ($ink) {
+                                    $query->where('inks.id', '=', $ink['id']);
+                                });
+                            }
+                        })                      
                         ->when($covers, function ($query, $covers) {
                             $query->whereIn('cover_id', array_column($covers, 'id'));
                         })
@@ -2517,11 +3016,17 @@ function ($query) use (
                     $hand_number_min,
                     $hand_number_max,
                     $scripts,
+                    $scripts_incl,
                     $diacritics,
+                    $diacritics_incl,
                     $punctuations,
+                    $punctuations_incl,
                     $paratexts,
+                    $paratexts_incl,
                     $decorations,
+                    $decorations_incl,
                     $critical_symbols,
+                    $critical_symbols_incl,
                     $paginations,
                     $quire_signatures
                 ) {
@@ -2531,36 +3036,78 @@ function ($query) use (
                         ->when($hand_number_max, function ($query, $hand_number_max) {
                             $query->where('hand_number', '<=', $hand_number_max);
                         })
-                        ->when($scripts, function ($query, $scripts) {
+                        ->when($scripts && !$scripts_incl, function ($query) use ($scripts) {
                             $query->whereHas('scripts', function ($query) use ($scripts) {
                                 $query->whereIn('scripts.id', array_column($scripts, 'id'));
                             });
                         })
-                        ->when($diacritics, function ($query, $diacritics) {
+                        ->when($scripts && $scripts_incl, function ($query) use ($scripts) {
+                            foreach($scripts as $script) {                                
+                                $query->whereHas('scripts', function($query) use ($script) {
+                                    $query->where('scripts.id', '=', $script['id']);
+                                });
+                            }
+                        }) 
+                        ->when($diacritics && !$diacritics_incl, function ($query) use ($diacritics) {
                             $query->whereHas('diacritics', function ($query) use ($diacritics) {
                                 $query->whereIn('diacritics.id', array_column($diacritics, 'id'));
                             });
                         })
-                        ->when($punctuations, function ($query, $punctuations) {
+                        ->when($diacritics && $diacritics_incl, function ($query) use ($diacritics) {
+                            foreach($diacritics as $diacritic) {                                
+                                $query->whereHas('diacritics', function($query) use ($diacritic) {
+                                    $query->where('diacritics.id', '=', $diacritic['id']);
+                                });
+                            }
+                        }) 
+                        ->when($punctuations && !$punctuations_incl, function ($query) use ($punctuations) {
                             $query->whereHas('punctuations', function ($query) use ($punctuations) {
                                 $query->whereIn('punctuations.id', array_column($punctuations, 'id'));
                             });
                         })
-                        ->when($paratexts, function ($query, $paratexts) {
+                        ->when($punctuations && $punctuations_incl, function ($query) use ($punctuations) {
+                            foreach($punctuations as $punctuation) {                                
+                                $query->whereHas('punctuations', function($query) use ($punctuation) {
+                                    $query->where('punctuations.id', '=', $punctuation['id']);
+                                });
+                            }
+                        }) 
+                        ->when($paratexts && !$paratexts_incl, function ($query) use ($paratexts) {
                             $query->whereHas('paratexts', function ($query) use ($paratexts) {
                                 $query->whereIn('paratexts.id', array_column($paratexts, 'id'));
                             });
                         })
-                        ->when($decorations, function ($query, $decorations) {
+                        ->when($paratexts && $paratexts_incl, function ($query) use ($paratexts) {
+                            foreach($paratexts as $paratext) {                                
+                                $query->whereHas('paratexts', function($query) use ($paratext) {
+                                    $query->where('paratexts.id', '=', $paratext['id']);
+                                });
+                            }
+                        }) 
+                        ->when($decorations && !$decorations_incl, function ($query) use ($decorations) {
                             $query->whereHas('decorations', function ($query) use ($decorations) {
                                 $query->whereIn('decorations.id', array_column($decorations, 'id'));
                             });
                         })
-                        ->when($critical_symbols, function ($query, $critical_symbols) {
+                        ->when($decorations && $decorations_incl, function ($query) use ($decorations) {
+                            foreach($decorations as $decoration) {                                
+                                $query->whereHas('decorations', function($query) use ($decoration) {
+                                    $query->where('decorations.id', '=', $decoration['id']);
+                                });
+                            }
+                        }) 
+                        ->when($critical_symbols && !$critical_symbols_incl, function ($query) use ($critical_symbols) {
                             $query->whereHas('critical_symbols', function ($query) use ($critical_symbols) {
                                 $query->whereIn('critical_symbols.id', array_column($critical_symbols, 'id'));
                             });
                         })
+                        ->when($critical_symbols && $critical_symbols_incl, function ($query) use ($critical_symbols) {
+                            foreach($critical_symbols as $critical_symbol) {                                
+                                $query->whereHas('critical_symbols', function($query) use ($critical_symbol) {
+                                    $query->where('critical_symbols.id', '=', $critical_symbol['id']);
+                                });
+                            }
+                        }) 
                         ->when($paginations, function ($query, $paginations) {
                             $query->whereHas('paginations', function ($query) use ($paginations) {
                                 $query->whereIn('paginations.id', array_column($paginations, 'id'));
@@ -2575,15 +3122,23 @@ function ($query) use (
                 $show_consanal == "true",
                 function ($query) use (
                     $storage_conditions,
-                    $analyses
+                    $analyses,
+                    $analyses_incl,
                 ) {
                     $query->when($storage_conditions, function ($query, $storage_conditions) {
                         $query->whereIn('storage_condition_id', array_column($storage_conditions, 'id'));
                     })
-                        ->when($analyses, function ($query, $analyses) {
+                        ->when($analyses && !$analyses_incl, function ($query) use ($analyses) {
                             $query->whereHas('analyses', function ($query) use ($analyses) {
                                 $query->whereIn('analyses.id', array_column($analyses, 'id'));
                             });
+                        })
+                        ->when($analyses && $analyses_incl, function ($query) use ($analyses) {
+                            foreach($analyses as $analysis) {                                
+                                $query->whereHas('analyses', function($query) use ($analysis) {
+                                    $query->where('analyses.id', '=', $analysis['id']);
+                                });
+                            }
                         });
                 }
             )
@@ -2594,7 +3149,9 @@ function ($query) use (
                     $ancient_provenances,
                     $ancient_provenance_certainties,
                     $transactions,
+                    $transactions_incl,
                     $transaction_parties,
+                    $transaction_parties_incl,
                     $legal_classifications
                 ) {
                     $query->when($scientifically_excavated, function ($query, $scientifically_excavated) {
@@ -2606,12 +3163,20 @@ function ($query) use (
                         ->when($ancient_provenance_certainties, function ($query, $ancient_provenance_certainties) {
                             $query->whereIn('ancient_provenance_certainty_id', array_column($ancient_provenance_certainties, 'id'));
                         })
-                        ->when($transactions, function ($query, $transactions) {
+                        ->when($transactions && !$transactions_incl, function ($query) use ($transactions) {
                             $query->whereHas('purchases', function ($query) use ($transactions) {
                                 $query->whereIn('purchases.id', array_column($transactions, 'id'));
                             });
                         })
-                        ->when($transaction_parties, function ($query, $transaction_parties) {
+                        ->when($transactions && $transactions_incl, function ($query) use ($transactions) {
+                            foreach($transactions as $transaction) {                                
+                                $query->whereHas('purchases', function($query) use ($transaction) {
+                                    $query->where('purchases.id', '=', $transaction['id']);
+                                });
+                            }
+                        }) 
+
+                        ->when($transaction_parties && !$transaction_parties_incl, function ($query) use ($transaction_parties) {
                             $tactions = Purchase::query()
                                 ->whereHas('purchase_parties', function ($query) use ($transaction_parties) {
                                     $query->whereIn('purchase_parties.id', array_column($transaction_parties, 'id'));
@@ -2620,14 +3185,24 @@ function ($query) use (
                                 $query->whereIn('purchases.id', array_column($tactions, 'id'));
                             });
                         })
+
+                        ->when($transaction_parties && $transaction_parties_incl, function ($query) use ($transaction_parties) {
+                            
+                            $query->whereHas('purchases', function ($query) use ($transaction_parties) {
+                                foreach($transaction_parties as $transaction_party) {
+                                    $query->whereHas('purchase_parties', function ($query) use ($transaction_party) {
+                                        $query->where('purchase_parties.id', '=', $transaction_party['id']);
+                                    });
+                                }
+                            });
+                        })
                         ->when($legal_classifications, function ($query, $legal_classifications) {
                             $query->whereIn('legal_classification_id', array_column($legal_classifications, 'id'));
                         });
-                }
-            )
+                    })
 
             ->orderBy($sortby, $direction)
-            ->orderBy('end_year', $direction)->get();
+            ->orderBy('end_year', $direction);
 
             $prev = -1;
             $next = -1;
@@ -2908,14 +3483,18 @@ function ($query) use (
             'title' => $title,
             'ancient_author' => $ancient_author,
             'genres_search' => $genres,
+            'genres_incl' => $genres_incl,
             'tags_search' => $tags,
+            'tags_incl' => $tags_incl,
             'earliest_date' => $earliest_date,
             'latest_date' => $latest_date,
             'exclusive_date' => $exclusive_date == "true" ? true : false,
             'dating_methods_search' => $dating_methods,
+            'dating_methods_incl' => $dating_methods_incl,
             'dating_certainties_search' => $dating_certainties,
             'materials_search' => $materials,
             'inks_search' => $inks,
+            'inks_incl' => $inks_incl == "true" ? true : false,
             'covers_search' => $covers,
             'quire_structures_search' => $quire_structures,
             'quirenum_min' => $quirenum_min,
@@ -2941,20 +3520,29 @@ function ($query) use (
             'hand_number_min' => $hand_number_min,
             'hand_number_max' => $hand_number_max,
             'scripts_search' => $scripts,
+            'scripts_incl' => $scripts_incl,
             'diacritics_search' => $diacritics,
+            'diacritics_incl' => $diacritics_incl,
             'punctuations_search' => $punctuations,
+            'punctuations_incl' => $punctuations_incl,
             'paratexts_search' => $paratexts,
+            'paratexts_incl' => $paratexts_incl,
             'decorations_search' => $decorations,
+            'decorations_incl' => $decorations_incl,
             'critical_symbols_search' => $critical_symbols,
+            'critical_symbols_incl' => $critical_symbols_incl,
             'paginations_search' => $paginations,
             'quire_signatures_search' => $quire_signatures,
             'storage_conditions_search' => $storage_conditions,
             'analyses_search' => $analyses,
+            'analyses_incl' => $analyses_incl,
             'scientifically_excavated' => $scientifically_excavated,
             'ancient_provenances_search' => $ancient_provenances,
             'ancient_provenance_certainties_search' => $ancient_provenance_certainties,
             'transactions_search' => $transactions,
+            'transactions_incl' => $transactions_incl,
             'transaction_parties_search' => $transaction_parties,
+            'transaction_parties_incl' => $transaction_parties_incl,
             'legal_classifications_search' => $legal_classifications,
 
             'sortfield' => $sortfield,
